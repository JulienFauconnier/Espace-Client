$(document).ready(function(){function t(t,i){1==t&&(o=$("#choix_type option:selected").attr("id"),s.html(""),s.append('<option id="none">Choisir une Catégorie</option>'),n=$("#choix_cat option:selected").attr("id")),1==i&&(n=$("#choix_cat option:selected").attr("id"),p.html(""),p.append('<option id="none">Choisir une Prestation</option>'),e=$("#choix_id option:selected").attr("id")),$("#addb").prop("disabled",!0)}function i(){$("#result").empty(),c=0,""!=a?$.each(a,function(){$("#result").append('<tr><td class="title">'+this.row_name+'</td><td class="description">'+this.row_notes+'</td><td class="quantity">'+this.row_qt+'</td><td class="price">'+Math.round(100*this.row_unitAmount)/100+'€</td><td class="price">'+Math.round(100*this.row_purchaseAmount)/100+'€</td><td class="cta-button"><button class="alert tiny radius rmv" id="'+c+'" type="button"><strong>X</strong></button></td></tr>'),c++}):($("#submit").prop("disabled",!0),$("#reset").prop("disabled",!0))}var o,n,e,c,d=$("#choix_qt").val(),s=$("#choix_cat"),p=$("#choix_id"),a=[];$(document).on("click",".rmv",function(){a.splice(this.id,1),i()}),t("1","1"),i(),$("#choix_type").change(function(){t(1,1),"none"!=o&&$.post("inc/getSTList.php",function(t){var i=jQuery.parseJSON(t);$.each(i,function(){s.append('<option id="'+this.word+'">'+this.word.substring(0,this.word.length-2)+"</option>")})})}),$("#choix_cat").change(function(){t(0,1),"none"!=o&&"none"!=n&&$.post("inc/getCList.php",{type:o,cat:n},function(t){var i=jQuery.parseJSON(t);$.each(i,function(){p.append('<option id="'+this.id+'">'+this.tradename+" - "+Math.round(100*this.unitAmount)/100+" € HT</option>")})})}),$("#choix_id").change(function(){e=$("#choix_id option:selected").attr("id"),"none"!=e?$("#addb").prop("disabled",!1):$("#addb").prop("disabled",!0)}),$("#choix_qt").change(function(){d=$(this).val()}),$("#addb").click(function(){$.post("inc/getCOne.php",{id:e,type:o,qt:d},function(t){a.push(jQuery.parseJSON(t)),i(),$("#submit").prop("disabled",!1),$("#reset").prop("disabled",!1)})}),$("#submit").click(function(){""!=a&&$.post("inc/createEDoc.php",{row:a},function(){a=[],i()})}),$("#reset").click(function(){a=[],i()})});