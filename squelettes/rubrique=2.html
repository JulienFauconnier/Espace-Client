<BOUCLE_PRINCIPALE(RUBRIQUES){id_rubrique}{tout}{lang_select=non}>
<INCLURE{fond=inc-html}{env}{lang}>
<head>
	<INCLURE{fond=identification_site}{env}{lang}>
	<INCLURE{fond=inc-meta}{env}{lang}>
	<INCLURE{fond=inc-meta-rubrique}{env}{lang}>
	<INCLURE{fond=inc-head}{env}{lang}>
	<?php
	include("inc/initAPI.php");
	?>
</head>
<body>
	<?php
	if($_POST['validate'] != 'ok') {
		?>
		<div class="row">
			<form method = "post" action = "#" data-abide>
				<div class="panel row">
					<h2>Vous êtes...</h2>
				</div>
				<ul class="tabs row" data-tab data-options="scroll_to_content: false">
					<li class="large-6 tab-title active"><a href="#corporation">Un Professionel</a></li>
					<li class="large-6 tab-title"><a href="#person">Un Particulier</a></li>
				</ul>
				<div class="tabs-content row">
					<div class="content active" id="corporation">
						<div class="large-6 columns">
							<fieldset>
								<legend>Informations de la Société</legend>
								<div>
									<label for="thirdName">Nom *
										<input type="text" id="thirdName" name="thirdName" placeholder="Votre-Entreprise" required />
									</label>
									<small class="error">Un nom de société est requis</small>
								</div>
								<div>
									<label for="thirdEmail">Mail *
										<input type="email" id="thirdEmail" name="thirdEmail" placeholder="mail@votre-entreprise.fr" required />
									</label>
									<small class="error">Un courriel valide est requis</small>
								</div>
								<div>
									<label for="thirdMobile">Mobile *
										<input type="text" id="thirdMobile" name="thirdMobile" pattern="^0[0-9]{9}" placeholder="0696000000" required />
									</label>
									<small class="error">Un numéro de mobile valide est requis</small>
								</div>
								<div>
									<label for="thirdTel">Tel
										<input type="text" id="thirdTel" name="thirdTel" pattern="^0[0-9]{9}" placeholder="0596000000" />
									</label>
									<small class="error">Numéro de téléphone invalide</small>
								</div>
								<div>
									<label for="thirdFax">Fax
										<input type="text" id="thirdFax" name="thirdFax" pattern="^0[0-9]{9}" placeholder="0596000000" />
									</label>
									<small class="error">Numéro de FAX invalide</small>
								</div>
							</fieldset>
						</div>
						<div class="large-6 columns">
							<fieldset>
								<legend>Informations Complémentaires (Facultatives)</legend>
								<div>
									<label for="thirdSiret">N° SIRET
										<input type="text" id="thirdSiret" name="thirdSiret" data-abide-validator="valid_siret" />
									</label>
									<small class="error">Numéro SIRET invalide</small>
								</div>
								<div>
									<label for="thirdApenaf">Code NAF(APE)
										<input type="text" id="thirdApenaf" name="thirdApenaf" data-abide-validator="valid_naf" />
									</label>
									<small class="error">Code invalide</small>
								</div>
								<div>
									<label for="thirdCapital">Capital Social
										<input type="text" id="thirdCapital" name="thirdCapital" pattern="number" />
									</label>
									<small class="error">Capital Social invalide</small>
								</div>
								<div>
									<label for="thirdRcs">RCS
										<input type="text" id="thirdRcs" name="thirdRcs" />
									</label>
									<small class="error">Numéro RCF invalide</small>
								</div>
								<div>
									<label for="thirdVat">N° TVA Intra
										<input type="text" id="thirdVat" name="thirdVat" data-abide-validator="valid_vat" />
									</label>
									<small class="error">Numéro de TVA Intra invalide</small>
								</div>
							</fieldset>
						</div>
					</div>
					<div class="content" id="person">
						<div class="large-6 columns">
						</div>
						<div class="large-6 columns">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="large-6 columns">
						<fieldset>
							<legend>Informations de Contact</legend>
							<div>
								<label for="contactForename">Prénom *
									<input type="text" id="contactForename" name="contactForename"  pattern="[a-zA-ZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØŒŠþÙÚÛÜÝŸàáâãäåæçèéêëìíîïðñòóôõöøœšÞùúûüýÿ\- ]+" placeholder="Albert" required />
								</label>
								<small class="error">Un prénom valide est requis</small>
							</div>
							<div>
								<label for="contactName">Nom *
									<input type="text" id="contactName" name="contactName" pattern="[a-zA-ZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØŒŠþÙÚÛÜÝŸàáâãäåæçèéêëìíîïðñòóôõöøœšÞùúûüýÿ\- ]+" placeholder="Enstein" required />
								</label>
								<small class="error">Un nom valide est requis</small>
							</div>
							<div>
								<label for="contactPosition">Fonction
									<input type="text" id="contactPosition" name="contactPosition" pattern="[a-zA-ZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØŒŠþÙÚÛÜÝŸàáâãäåæçèéêëìíîïðñòóôõöøœšÞùúûüýÿ\- ]+" placeholder="Gérant" />
								</label>
								<small class="error">Un nom de fonction valide est requis</small>
							</div>
							<div>
								<label for="contactEmail">Mail *
									<input type="email" id="contactEmail" name="contactEmail" placeholder="contact@votre-entreprise.fr" required />
								</label>
								<small class="error">Un courriel valide est requis</small>
							</div>
							<div>
								<label for="contactMobile">Mobile *
									<input type="tel" id="contactMobile" name="contactMobile" pattern="^0[0-9]{9}" placeholder="0696000000" required />
								</label>
								<small class="error">Un numéro de mobile valide est requis</small>
							</div>
							<div>
								<label for="contactTel">Tel
									<input type="tel" id="contactTel" name="contactTel" pattern="^0[0-9]{9}" placeholder="0596000000" />
								</label>
								<small class="error">Numéro de téléphone invalide</small>
							</div>
							<div>
								<label for="contactFax">Fax
									<input type="tel" id="contactFax" name="contactFax" pattern="^0[0-9]{9}" placeholder="0596000000" />
								</label>
								<small class="error">Numéro de FAX invalide</small>
							</div>
						</fieldset>
					</div>
					<div class="large-6 columns">
						<fieldset>
							<legend>Adresse</legend>
							<div>
								<label for="thirdWeb">Site web
									<input type="url" id="thirdWeb" name="thirdWeb" placeholder="http://www.votre-entreprise.fr" />
								</label>
								<small class="error">URL invalide</small>
							</div>
							<div>
								<label for="addressPart1">Adresse *
									<input type="text" id="addressPart1" name="addressPart1" required />
								</label>
								<small class="error">Une adresse valide est requise</small>
							</div>
							<div>
								<label for="addressPart2">Adresse (Suite)
									<input type="text" id="addressPart2" name="addressPart2" />
								</label>
								<small class="error">Suite de l'adresse invalide</small>
							</div>
							<div>
								<label for="addressZip">Code Postal *
									<input type="text" id="addressZip" name="addressZip" pattern="[0-9]{5}" placeholder="97200" required />
								</label>
								<small class="error">Une Code Postal valide est requis</small>
							</div>
							<div>
								<label for="addressTown">Ville *
									<input type="text" id="addressTown" name="addressTown" placeholder="Fort-de-France" required />
								</label>
								<small class="error">Une Ville valide est requise</small>
							</div>
							<div>
								<label for="addressCountrycode">Code Pays *
									<input type="text" id="addressCountrycode" name="addressCountryCode" placeholder="FR" required />
								</label>
								<small class="error">Un Code Pays valide est requis</small>
							</div>
						</fieldset>
					</div>
				</div>
				<div class="row">
					<div class="medium-2 medium-push-4 large-2 large-push-4 columns text-right">
						<button class="expand radius medium green" type="submit">Envoyer</button>
					</div>
					<div class="medium-2 medium-pull-4 large-2 large-pull-4 large columns text-left">
						<button class="expand radius medium green" type="reset">Réinitialiser</button>
					</div>
				</div>
				<input type="hidden" name="validate" id="validate" value="ok"/>
			</form>
		</div>
		<INCLURE{fond=inc-foot}{env}{lang}>
		<script src="js/csValidate.min.js"></script>
		<script>
			$('#person').on('toggled', function (event, tab) {
				// Informations de la Société
				$("#thirdName").prop('disabled', true);
				$("#thirdEmail").prop('disabled', true);
				$("#thirdMobile").prop('disabled', true);
				$("#thirdTel").prop('disabled', true);
				$("#thirdFax").prop('disabled', true);
				// Informations Complémentaires (Facultatives)
				$("#thirdSiret").prop('disabled', true);
				$("#thirdApenaf").prop('disabled', true);
				$("#thirdCapital").prop('disabled', true);
				$("#thirdRcs").prop('disabled', true);
				$("#thirdVat").prop('disabled', true);
			});
			$('#corporation').on('toggled', function (event, tab) {
				// Informations de la Société
				$("#thirdName").prop('disabled', false);
				$("#thirdEmail").prop('disabled', false);
				$("#thirdMobile").prop('disabled', false);
				$("#thirdTel").prop('disabled', false);
				$("#thirdFax").prop('disabled', false);
				// Informations Complémentaires (Facultatives)
				$("#thirdSiret").prop('disabled', false);
				$("#thirdApenaf").prop('disabled', false);
				$("#thirdCapital").prop('disabled', false);
				$("#thirdRcs").prop('disabled', false);
				$("#thirdVat").prop('disabled', false);
			});
		</script>
	</body>
	<?php
}
else {
	if (isset($_POST['thirdName'], $_POST['thirdEmail'], $_POST['thirdMobile'], $_POST['thirdTel'], $_POST['thirdFax'],
		$_POST['thirdSiret'], $_POST['thirdApenaf'], $_POST['thirdCapital'], $_POST['thirdRcs'], $_POST['thirdVat'])) {
		$request = array(
			'method' => 'Prospects.create',
			'params' => array(
				'third' => array(
					'name'			=> $_POST['thirdName'],
					'type'			=> "corporation",
					'email'			=> $_POST['thirdEmail'],
					'tel'			=> $_POST['thirdTel'],
					'fax'			=> $_POST['thirdFax'],
					'mobile'		=> $_POST['thirdMobile'],
					'web'			=> $_POST['thirdWeb'],
					'siret'			=> $_POST['thirdSiret'],
					'vat'			=> $_POST['thirdVat'],
					'rcs'			=> $_POST['thirdRcs'],
					'apenaf'		=> $_POST['thirdApenaf'],
					'capital'		=> $_POST['thirdCapital'],
					'tags'			=> "from_website"
					//'accountingcode'=> "thirdAccountingcode", // Aucune idée
					//'auxcode'		=> "thirdAuxcode", // Aucune idée
					//'stickyNote'	=> "thirdStickyNote" // Aucune idée
				),
				'contact' => array(
					'name'		=> $_POST['contactName'],
					'forename'	=> $_POST['contactForename'],
					'email'		=> $_POST['contactEmail'],
					'tel'		=> $_POST['contactTel'],
					'fax'		=> $_POST['contactFax'],
					'mobile'	=> $_POST['contactMobile'],
					'position'	=> $_POST['contactPosition']
				),
				'address' => array(
					'name'		=> "Bureau",
					'part1'		=> $_POST['addressPart1'],
					'part2'		=> $_POST['addressPart2'],
					'zip'		=> $_POST['addressZip'],
					'town'		=> $_POST['addressTown'],
					'countrycode'	=> $_POST['addressCountrycode']
				)
			)
		);
	}
	else {
		$request = array(
			'method' => 'Prospects.create',
			'params' => array(
				'third' => array(
					'name'			=> $_POST['contactName'],
					'type'			=> "person",
					//'email'			=> $_POST['thirdEmail'],
					//'tel'			=> $_POST['thirdTel'],
					//'fax'			=> $_POST['thirdFax'],
					//'mobile'		=> $_POST['thirdMobile'],
					'web'			=> $_POST['thirdWeb'],
					//'siret'			=> $_POST['thirdSiret'],
					//'vat'			=> $_POST['thirdVat'],
					//'rcs'			=> $_POST['thirdRcs'],
					//'apenaf'		=> $_POST['thirdApenaf'],
					//'capital'		=> $_POST['thirdCapital'],
					'tags'			=> "from_website"
					//'accountingcode'=> "thirdAccountingcode", // Aucune idée
					//'auxcode'		=> "thirdAuxcode", // Aucune idée
					//'stickyNote'	=> "thirdStickyNote" // Aucune idée
				),
				'contact' => array(
					'name'		=> $_POST['contactName'],
					'forename'	=> $_POST['contactForename'],
					'email'		=> $_POST['contactEmail'],
					'tel'		=> $_POST['contactTel'],
					'fax'		=> $_POST['contactFax'],
					'mobile'	=> $_POST['contactMobile'],
					'position'	=> $_POST['contactPosition']
				),
				'address' => array(
					'name'		=> "Bureau",
					'part1'		=> $_POST['addressPart1'],
					'part2'		=> $_POST['addressPart2'],
					'zip'		=> $_POST['addressZip'],
					'town'		=> $_POST['addressTown'],
					'countrycode'	=> $_POST['addressCountrycode']
				)
			)
		);
	}
	$result = sellsyConnect::load()->requestApi($request);
	header('Location: #URL_SITE_SPIP');
}
?>
</html>
</BOUCLE_PRINCIPALE>